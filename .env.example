# =============================================================
# Docker Watch (.env) — /opt/docker-watch/.env
# =============================================================

# --- Telegram (obligatorio) ---
BOT_TOKEN="123456789:AAExampleTokenReplaceMe"
CHAT_ID="-1001234567890"

# --- Filtrado por label (recomendado para evitar ruido) ---
# Monitorea SOLO contenedores con este label:
# Formato: KEY=VAL
MONITOR_LABEL="dockwatch.monitor=true"

# --- Comportamiento (tu preferencia: 1 alerta y silencio) ---
# - Envía 1 alerta por incidente y suprime repeticiones.
# - NO envía mensaje de recuperación.
# - NO hace autorestart.

# “Cierre silencioso” del incidente:
# - si el contenedor tiene healthcheck: cuando vuelva a "healthy"
# - si NO tiene healthcheck: cuando esté "Up" estable por >= RECOVERY_GRACE_SEC
RECOVERY_GRACE_SEC="300"

# Anti-spam: ventana máxima de silencio si un incidente no cierra (safety net).
# Si expira, se permite una nueva alerta.
TTL_DIE_SEC="1800"        # 30m
TTL_UNHEALTHY_SEC="3600"  # 60m

# Si un incidente escala (unhealthy -> die), se edita el MISMO mensaje (no manda uno nuevo)
MAX_EDITS_PER_INCIDENT="1"

# --- Auditoría local (JSONL) ---
DOCKER_WATCH_LOG_DIR="/var/log/docker-watch"
DOCKER_WATCH_EVENTS_LOG="/var/log/docker-watch/events.jsonl"

# --- Heartbeat (diario) ---
HEARTBEAT_ALERTS_ONLY="false"   # true => solo manda si hay unhealthy/stopped
HEARTBEAT_TOP_RESTARTERS="3"

# Forzar heartbeat aunque ya se haya enviado hoy:
# HEARTBEAT_FORCE="true"
